<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ROS2 Control App</title>
  <style>
    body {
      background-color: #000;
      color: #fff;
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    h1 {
      margin-top: 40px;
    }
    .button {
      background-color: #444;
      border: none;
      border-radius: 5px;
      color: #fff;
      padding: 15px 25px;
      margin: 10px;
      cursor: pointer;
      font-size: 16px;
      transition: background-color 0.3s, transform 0.2s;
    }
    .button:hover {
      background-color: #666;
      transform: scale(1.05);
    }
    .status-indicator {
      display: inline-block;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background-color: #800; /* default red for offline */
      margin-left: 10px;
      vertical-align: middle;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
      transition: background-color 0.3s ease, box-shadow 0.3s ease;
    }
    pre {
      background: #111;
      padding: 10px;
      border-radius: 5px;
      text-align: left;
      max-width: 600px;
      margin: 20px auto;
    }
    .container {
      padding: 20px;
    }
  </style>
  <script>
    async function controlNode(action) {
      const url = `/api/nodes/${action}`;
      const response = await fetch(url, { method: 'POST' });
      const result = await response.json();
      document.getElementById('result').innerText = JSON.stringify(result, null, 2);
      updateStatusIndicator();
    }

    async function checkStatus() {
      const response = await fetch('/api/nodes/status');
      const result = await response.json();
      document.getElementById('result').innerText = JSON.stringify(result, null, 2);
      updateStatusIndicator(result);
    }

    function updateStatusIndicator(statusData) {
      if (statusData) {
        setIndicator(statusData.status);
      } else {
        fetch('/api/nodes/status')
          .then(response => response.json())
          .then(data => {
            setIndicator(data.status);
          });
      }
    }

    function setIndicator(status) {
      const indicator = document.getElementById('statusIndicator');
      if (status === 'running') {
        indicator.style.backgroundColor = '#0f0'; // green for running
        indicator.style.boxShadow = '0 0 20px #0f0';
      } else {
        indicator.style.backgroundColor = '#800'; // red for offline
        indicator.style.boxShadow = '0 0 15px rgba(0, 0, 0, 0.5)';
      }
    }

    // Initial status check on load.
    window.onload = function() {
      updateStatusIndicator();
    }
  </script>
</head>
<body>
  <div class="container">
    <h1>Welcome to the ROS2 Control App</h1>
    <p>
      Use the buttons below to control the turtlesim node:
      <span class="status-indicator" id="statusIndicator"></span>
    </p>
    <button class="button" onclick="controlNode('start')">Start Turtlesim Node</button>
    <button class="button" onclick="checkStatus()">Check Node Status</button>
    <button class="button" onclick="controlNode('stop')">Stop Turtlesim Node</button>
  
    <h3>Result:</h3>
    <pre id="result"></pre>
  </div>
</body>
</html>
